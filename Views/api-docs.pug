doctype html
html(lang='en')
  head
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')
    title Natours API Documentation
    style.
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #55c57a, #28b485);
        min-height: 100vh;
      }
      
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: white;
        margin-top: 20px;
        margin-bottom: 20px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      }
      
      .header {
        text-align: center;
        padding: 40px 0;
        background: linear-gradient(135deg, #55c57a, #28b485);
        color: white;
        border-radius: 10px 10px 0 0;
        margin: -20px -20px 40px -20px;
      }
      
      .header h1 {
        font-size: 3rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      }
      
      .header .version {
        font-size: 1.2rem;
        opacity: 0.9;
      }
      
      .nav {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 40px;
        flex-wrap: wrap;
      }
      
      .nav-link {
        padding: 10px 20px;
        background: #55c57a;
        color: white;
        text-decoration: none;
        border-radius: 5px;
        transition: background 0.3s;
      }
      
      .nav-link:hover {
        background: #28b485;
      }
      
      .section {
        margin-bottom: 50px;
      }
      
      .section h2 {
        color: #28b485;
        font-size: 2.2rem;
        margin-bottom: 20px;
        border-bottom: 3px solid #55c57a;
        padding-bottom: 10px;
      }
      
      .section h3 {
        color: #333;
        font-size: 1.5rem;
        margin: 30px 0 15px 0;
      }
      
      .endpoints-grid {
        display: grid;
        gap: 20px;
      }
      
      .endpoint-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        background: #f9f9f9;
        transition: transform 0.2s, box-shadow 0.2s;
      }
      
      .endpoint-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      }
      
      .method {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 4px;
        font-weight: bold;
        font-size: 0.85rem;
        margin-right: 10px;
      }
      
      .method-GET { background: #28a745; color: white; }
      .method-POST { background: #007bff; color: white; }
      .method-PATCH { background: #ffc107; color: black; }
      .method-DELETE { background: #dc3545; color: white; }
      
      .endpoint-path {
        font-family: 'Courier New', monospace;
        background: #e9ecef;
        padding: 8px 12px;
        border-radius: 4px;
        margin: 10px 0;
        font-size: 0.9rem;
        border-left: 4px solid #55c57a;
      }
      
      .auth-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        margin-top: 8px;
      }
      
      .auth-none { background: #28a745; color: white; }
      .auth-required { background: #dc3545; color: white; }
      
      .feature-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }
      
      .feature-card {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        border-left: 4px solid #55c57a;
      }
      
      .feature-card h4 {
        color: #28b485;
        margin-bottom: 10px;
      }
      
      .example-box {
        background: #263238;
        color: #fff;
        padding: 15px;
        border-radius: 5px;
        font-family: 'Courier New', monospace;
        font-size: 0.9rem;
        margin: 10px 0;
        overflow-x: auto;
      }
      
      .geospatial-examples {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }
      
      .footer {
        text-align: center;
        padding: 30px 0;
        margin-top: 50px;
        border-top: 2px solid #55c57a;
        color: #666;
      }
      
      @media (max-width: 768px) {
        .container {
          margin: 10px;
          padding: 15px;
        }
        
        .header h1 {
          font-size: 2rem;
        }
        
        .nav {
          flex-direction: column;
          align-items: center;
        }
        
        .geospatial-examples {
          grid-template-columns: 1fr;
        }
      }

  body
    .container
      .header
        h1 üåø #{title}
        .version Version #{version}
        p #{description}
      
      .nav
        a.nav-link(href='#overview') Overview
        a.nav-link(href='#authentication') Authentication
        a.nav-link(href='#tours') Tours
        a.nav-link(href='#users') Users
        a.nav-link(href='#reviews') Reviews
        a.nav-link(href='#geospatial') Geospatial
        a.nav-link(href='#examples') Examples
      
      section#overview.section
        h2 üìä API Overview
        p.
          Welcome to the Natours API! This comprehensive REST API provides everything you need 
          to manage tours, users, and reviews with advanced features like geospatial queries, 
          role-based authentication, and real-time data filtering.
        
        .feature-list
          .feature-card
            h4 üîç Advanced Filtering
            p Support for complex queries with operators (gte, lte, gt, lt) for precise data retrieval
          
          .feature-card
            h4 üîÑ Sorting & Pagination
            p Multi-field sorting with efficient pagination for optimal performance
          
          .feature-card
            h4 üåç Geospatial Queries
            p Location-based searches and distance calculations using MongoDB 2dsphere indexes
          
          .feature-card
            h4 üîê JWT Authentication
            p Secure token-based authentication with role-based access control
          
          .feature-card
            h4 üõ°Ô∏è Security Features
            p Rate limiting, data sanitization, XSS protection, and security headers
          
          .feature-card
            h4 üìà Aggregation Pipelines
            p Statistical analysis and data grouping for comprehensive insights

        .example-box
          | Base URL: #{baseUrl}
          br
          | Rate Limit: 100 requests per hour per IP
          br
          | Content-Type: application/json

      section#authentication.section
        h2 üîê Authentication Endpoints
        .endpoints-grid
          each route in endpoints.authentication.routes
            .endpoint-card
              span.method(class=`method-${route.method}`)= route.method
              .endpoint-path= route.path
              p= route.description
              if route.authentication === 'None'
                span.auth-badge.auth-none No Authentication Required
              else
                span.auth-badge.auth-required= route.authentication

      section#tours.section
        h2 üèîÔ∏è Tours Endpoints
        p= endpoints.tours.description
        .endpoints-grid
          each route in endpoints.tours.routes
            .endpoint-card
              span.method(class=`method-${route.method}`)= route.method
              .endpoint-path= route.path
              p= route.description
              if route.authentication === 'None'
                span.auth-badge.auth-none No Authentication Required
              else
                span.auth-badge.auth-required= route.authentication
              if route.example
                .example-box= route.example

      section#users.section
        h2 üë• Users Endpoints
        p= endpoints.users.description
        .endpoints-grid
          each route in endpoints.users.routes
            .endpoint-card
              span.method(class=`method-${route.method}`)= route.method
              .endpoint-path= route.path
              p= route.description
              if route.authentication === 'None'
                span.auth-badge.auth-none No Authentication Required
              else
                span.auth-badge.auth-required= route.authentication

      section#reviews.section
        h2 ‚≠ê Reviews Endpoints
        p= endpoints.reviews.description
        .endpoints-grid
          each route in endpoints.reviews.routes
            .endpoint-card
              span.method(class=`method-${route.method}`)= route.method
              .endpoint-path= route.path
              p= route.description
              if route.authentication === 'None'
                span.auth-badge.auth-none No Authentication Required
              else
                span.auth-badge.auth-required= route.authentication
              if route.note
                p.
                  <strong>Note:</strong> #{route.note}

      section#geospatial.section
        h2 üåç Geospatial Features
        p= geospatialFeatures.description
        
        h3 Available Endpoints
        ul
          each endpoint in geospatialFeatures.availableEndpoints
            li= endpoint
        
        h3 Use Cases
        ul
          each useCase in geospatialFeatures.useCases
            li= useCase
        
        h3 Examples
        .geospatial-examples
          .example-box
            strong Find Tours Near Los Angeles (400 miles):
            br
            | #{geospatialFeatures.examples.findToursNearLosAngeles}
          
          .example-box
            strong Find Tours Near New York (200 km):
            br
            | #{geospatialFeatures.examples.findToursNearNewYork}
          
          .example-box
            strong Calculate Distances from Miami:
            br
            | #{geospatialFeatures.examples.calculateDistancesFromMiami}
          
          .example-box
            strong Calculate Distances from London:
            br
            | #{geospatialFeatures.examples.calculateDistancesFromLondon}

      section#examples.section
        h2 üìù Usage Examples
        
        h3 Authentication Header
        .example-box
          | Authorization: Bearer your-jwt-token-here

        h3 Advanced Filtering
        .example-box
          | GET #{baseUrl}/tours?difficulty=easy&price[lte]=1000&ratingsAverage[gte]=4.5

        h3 Sorting and Pagination
        .example-box
          | GET #{baseUrl}/tours?sort=-ratingsAverage,price&page=2&limit=10

        h3 Field Selection
        .example-box
          | GET #{baseUrl}/tours?fields=name,price,duration,difficulty

        h3 Create a Review
        .example-box
          | POST #{baseUrl}/tours/:tourId/reviews
          br
          | Content-Type: application/json
          br
          | Authorization: Bearer your-jwt-token
          br
          br
          | {
          br
          |   "review": "Amazing tour with breathtaking views!",
          br
          |   "rating": 5
          br
          | }

      .footer
        p.
          üåø Natours API Documentation | Built with Express.js, MongoDB, and Node.js
        p.
          For support or questions, please contact the development team.
